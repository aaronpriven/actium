sub gettitle {
      my @routes = @_;

      return "AC Transit Line $routes[0] " . getname($routes[0])
           if ($#routes == 0);

      my %routenames = ();
      my %topnums = ();

      push @{$routenames{getname($_)}} , $_ foreach @routes;

      # So $routenames{"Fred"} is a reference to an array of all the 
      # headnums whose name is "Fred"
 
      foreach (keys (%routenames)) {
         $topnums{$_} = ((sort byroutes @{$headnames{$_}})[0])
      }

      # now $topnums{$_} is the *first* number, in route order,
      # that uses the name $_

      # so this prints the routes in order of the first number of each
      # name.

      # I don't know if all this complication is necessary, but now it
      # should properly print 49 / 49M Harbor Bay -- 49X Harbor Bay Express"

      my $title = "AC Transit Lines ";
      my $prev = 0;
      foreach (sort byroutes values(%topnums)) {
         $title .= " -- " if $prev;
         $prev = 1;
         my $thisname = getname($_);
         $title .= join (" / " , @{$headnames{$thisname}} ) , " " , $thisname ;
      }
}

sub getname {
   my $num = shift;
   our %lines;
   return ($lines{$num}{Name});
}

